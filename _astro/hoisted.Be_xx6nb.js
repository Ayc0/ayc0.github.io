import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{R as s}from"./index.SSXOyoI7.js";import{r as w,c as C}from"./client.CjOa4Xn9.js";import"./index.CzFDRTuY.js";const E=()=>`lch(${Math.floor(Math.random()*20)+50}% ${Math.floor(Math.random()*50)+50} ${Math.floor(Math.random()*360)})`;let d=65;const g=s.createContext(!1);function v(t,n,r){r?(console.log(performance.now().toFixed(1)+"ms "+t,n),queueMicrotask(function(){console.log(performance.now().toFixed(1)+"ms microtask "+t,n)}),requestAnimationFrame(function(){console.log(performance.now().toFixed(1)+"ms requestAnimationFrame "+t,n)}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms user-blocking task "+t,n)},{priority:"user-blocking"}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms user-visible task "+t,n)},{priority:"user-visible"}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms background task "+t,n)},{priority:"background"})):console.log(t,n)}class a extends s.Component{state={error:!1};static getDerivedStateFromError(){return{error:!0}}render(){return this.state.error?e.jsx("div",{style:{border:"2px dashed red"},children:"Oops"}):e.jsx(s.Suspense,{fallback:e.jsx("div",{style:{border:"4px dotted blue",padding:"4px"},children:"⏸️"}),children:e.jsx("div",{style:{border:"4px dotted red",padding:"4px"},children:this.props.children})})}}function m(){const[t,n]=s.useState(!1);if(t)throw new Error("oops");return e.jsx("span",{onClick:()=>n(!0),title:"throw error",children:"💥"})}function f(){const[t,n]=s.useState(!1);if(t)throw new Promise(r=>{});return e.jsx("span",{onClick:()=>n(!0),title:"trigger infinite suspense",children:"🚧"})}class u extends s.Component{static contextType=g;color=E();componentId=String.fromCharCode(d++);log(n){v(`%cComponent ${this.componentId}: ${n}`,`color: ${this.color}`,this.context)}constructor(n){super(n),this.log("constructor")}componentWillMount(){this.log("componentWillMount")}componentWillReceiveProps(){this.log("componentWillReceiveProps")}componentWillUpdate(){this.log("componentWillUpdate")}componentDidMount(){this.log("componentDidMount")}componentDidUpdate(){this.log("componentDidUpdate")}shouldComponentUpdate(){return this.log("shouldComponentUpdate"),!0}getSnapshotBeforeUpdate(){this.log("getSnapshotBeforeUpdate")}componentWillUnmount(){this.log("componentWillUnmount")}render(){return this.log("render"),e.jsxs("div",{ref:function(r){this.log("ref "+(r?"node":"null"))}.bind(this),style:{border:`2px ${this.props.dashed?"dashed":"solid"} ${this.color}`},children:[e.jsxs("div",{children:[this.componentId,e.jsx("span",{onClick:()=>this.forceUpdate(),title:"re-render",children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column"},children:this.props.children})]})}}class M extends u{render(){return this.log("render"),e.jsxs("div",{ref:function(r){this.log("ref "+(r?"node":"null"))}.bind(this),style:{border:`2px solid ${this.color}`},children:[e.jsxs("div",{children:[this.componentId,"*",e.jsx("span",{onClick:()=>this.forceUpdate(),title:"re-render",children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsxs("div",{style:{display:"grid",gridAutoFlow:"column"},children:[e.jsx("span",{}),e.jsx(u,{dashed:!0}),e.jsx("span",{})]})]})}}function T(){return e.jsxs(u,{children:[e.jsx(a,{children:e.jsx(u,{children:e.jsx(u,{})})}),e.jsx(a,{children:e.jsx(M,{})})]})}const b=()=>{const t=s.useMemo(()=>E(),[]),n=s.useMemo(()=>String.fromCharCode(d++),[]),r=s.useContext(g),o=s.useCallback(l=>{v(`%cComponent ${n}: ${l}`,`color: ${t}`,r)},[r]);o("render");const[i,c]=s.useState({});return s.useMemo(function(){o("useMemo")},[]),s.useInsertionEffect(function(){return o("useInsertionEffect"),function(){o("useInsertionEffect cleanup")}},[i]),s.useLayoutEffect(function(){return o("useLayoutEffect"),function(){o("useLayoutEffect cleanup")}},[i]),s.useEffect(function(){return o("useEffect"),function(){o("useEffect cleanup")}},[i]),{log:o,color:t,componentId:n,forceUpdate:c}};function h({children:t,dashed:n}){const{log:r,color:o,componentId:i,forceUpdate:c}=b();return e.jsxs("div",{ref:function(p){r("ref "+(p?"node":"null"))},style:{border:`2px ${n?"dashed":"solid"} ${o}`},children:[e.jsxs("div",{children:[i,e.jsx("span",{onClick:()=>c({}),title:"re-render",children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column"},children:t})]})}function S({children:t}){const{log:n,color:r,componentId:o,forceUpdate:i}=b();return e.jsxs("div",{ref:function(l){n("ref "+(l?"node":"null"))}.bind(this),style:{border:`2px solid ${r}`},children:[e.jsxs("div",{children:[o,"*",e.jsx("span",{onClick:()=>i({}),title:"re-render",children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsxs("div",{style:{display:"grid",gridAutoFlow:"column"},children:[e.jsx("span",{}),e.jsx(h,{dashed:!0}),e.jsx("span",{})]})]})}function F(){return e.jsxs(h,{children:[e.jsx(a,{children:e.jsx(h,{children:e.jsx(h,{})})}),e.jsx(a,{children:e.jsx(S,{})})]})}const j={class:T,function:F};function y(){const[t,n]=s.useState(null),r=j[t],[o,i]=s.useState(!1);return e.jsxs("div",{className:"App",children:[e.jsxs("div",{children:["Timing ",o?"enabled ":"disabled ",e.jsx("button",{title:`Toggle timing to ${o?"disabled ":"enabled "}`,onClick:()=>{console.clear(),d=65,i(!o)},children:o?"️⌛":"⏳"})]}),e.jsxs("div",{children:["Pick example:",e.jsx("button",{onClick:()=>{console.clear(),d=65,n(null)},children:"Remove all"}),Object.keys(j).map(c=>e.jsx("button",{onClick:()=>{console.clear(),d=65,n(c)},children:c},c))]}),e.jsx(g.Provider,{value:o,children:e.jsx(a,{children:r&&e.jsx(r,{},String(o))})})]})}const x=!!sessionStorage.getItem("legacyRoot");function I(){return e.jsx(e.Fragment,{children:e.jsxs("button",{onClick:()=>{x?sessionStorage.removeItem("legacyRoot"):sessionStorage.setItem("legacyRoot","true"),window.location.reload()},children:["Switch to ",x?"concurrent":"legacy"]})})}const k=document.getElementById("root");x?w.render(e.jsx(y,{}),k):C(k).render(e.jsx(y,{}));C(document.getElementById("switcher")).render(e.jsx(I,{}));
