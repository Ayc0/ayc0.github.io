import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.F28aNuxU.js";import{c as g}from"./client.Dmkom2YY.js";import{g as k,a as x}from"./chunk-347RWTP3.CDTHZpip.js";import"./index.BF-YhwgH.js";function c(r){return r?typeof r.type=="string"?r.type:x(r):null}function b(r){const o=Object.keys(r).find(y=>y.startsWith("__reactFiber$"));return o?r[o]:void 0}function d(r){return{fiberName:c(r),fiberStack:r?k(r).map(c).filter(Boolean).reverse().join(" > "):null}}class j extends n.Component{constructor(e){super(e),this.state={hasError:!1}}static{this.displayName="ErrorBoundary"}static getDerivedStateFromError(e){return{hasError:!0}}render(){return this.state.hasError?this.props.fallback||null:this.props.children}}const u=()=>t.jsx("button",{onClick:()=>{throw new Error("Hello")},children:"Trigger ðŸ’¥ crash (in onClick)"});u.displayName="ErrorThrowerOnClick";function s(){const[r,e]=n.useState(!1);if(r)throw new Error("Hello");return t.jsx("button",{onClick:()=>{e(!0)},children:"Trigger ðŸ’¥ crash (on render)"})}s.displayName="ErrorThrowerOnRender";const p=()=>{const[r,e]=n.useState(!1);return n.useEffect(()=>{if(r)throw new Error("Hello")},[r]),t.jsx("button",{onClick:()=>{e(!0)},children:"Trigger ðŸ’¥ crash (on effect)"})};p.displayName="ErrorThrowerOnEffect";const h=({children:r})=>t.jsxs("fieldset",{style:{display:"inline",border:"1px dashed blue"},onClick:e=>{const o=b(e.target);if(!o)return;const i=d(o);console.log("Clicked on",{element:e.target,fiber:o,...i})},children:[t.jsx("legend",{children:"Click Tracker"}),r]});h.displayName="ClickTracker";const m=()=>t.jsxs(h,{children:[t.jsx(u,{}),t.jsx(s,{}),t.jsx(j,{children:t.jsxs("fieldset",{style:{display:"inline",border:"1px solid red"},children:[t.jsx("legend",{children:"Error Boundary"}),t.jsx(s,{}),t.jsx(p,{})]})})]});m.displayName="Bar";const f=()=>t.jsx(m,{});f.displayName="Foo";const E=()=>t.jsxs(t.Fragment,{children:[t.jsx("div",{children:"Hello World"}),t.jsx(f,{})]});E.displayName="App";function a(r){if(r.componentStack)return r.componentStack.trim().split(`
`).map(e=>e.trim().replace(/^at (.*?) \(.*?\)$/,"$1")).reverse().join(" > ")}const l=document.getElementById("button");l.addEventListener("click",()=>{g.createRoot(document.getElementById("node"),{onCaughtError(r,e){const o=e.errorBoundary?._reactInternals;console.log("Error caught by Error Boundary",{boundaryStack:o?d(o).fiberStack:null,errorStack:a(e)})},onUncaughtError(r,e){console.log("Error not caught by Error Boundary",{errorStack:a(e),error:r})},onRecoverableError(r,e){console.log("Recoverable error",{errorStack:a(e),error:r})}}).render(t.jsx(E,{})),l.disabled=!0});
