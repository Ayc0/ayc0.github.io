import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.F28aNuxU.js";import{c as k}from"./client.Dmkom2YY.js";import"./index.BF-YhwgH.js";/**
 * @license bippy
 *
 * Copyright (c) Aiden Bai, Million Software, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=e=>{const r=[];let n=e;for(;n.return;)r.push(n),n=n.return;return r},u=e=>{const r=e;return typeof r=="function"?r:typeof r=="object"&&r?u(r.type||r.render):null},j=e=>{const r=e;if(typeof r!="function"&&!(typeof r=="object"&&r))return null;const n=r.displayName||r.name||null;if(n)return n;const o=u(r);return o&&(o.displayName||o.name)||null};function i(e){return e?typeof e.type=="string"?e.type:j(e):null}function x(e){const n=Object.keys(e).find(g=>g.startsWith("__reactFiber$"));return n?e[n]:void 0}function d(e){return{fiberName:i(e),fiberStack:e?b(e).map(i).filter(Boolean).reverse().join(" > "):null}}class T extends a.Component{constructor(r){super(r),this.state={hasError:!1}}static{this.displayName="ErrorBoundary"}static getDerivedStateFromError(r){return{hasError:!0}}render(){return this.state.hasError?this.props.fallback||null:this.props.children}}const p=()=>t.jsx("button",{onClick:()=>{throw new Error("Hello")},children:"Trigger ðŸ’¥ crash (in onClick)"});p.displayName="ErrorThrowerOnClick";function c(){const[e,r]=a.useState(!1);if(e)throw new Error("Hello");return t.jsx("button",{onClick:()=>{r(!0)},children:"Trigger ðŸ’¥ crash (on render)"})}c.displayName="ErrorThrowerOnRender";const f=()=>{const[e,r]=a.useState(!1);return a.useEffect(()=>{if(e)throw new Error("Hello")},[e]),t.jsx("button",{onClick:()=>{r(!0)},children:"Trigger ðŸ’¥ crash (on effect)"})};f.displayName="ErrorThrowerOnEffect";const y=({children:e})=>t.jsxs("fieldset",{style:{display:"inline",border:"1px dashed blue"},onClick:r=>{const n=x(r.target);if(!n)return;const o=d(n);console.log("Clicked on",{element:r.target,fiber:n,...o})},children:[t.jsx("legend",{children:"Click Tracker"}),e]});y.displayName="ClickTracker";const h=()=>t.jsxs(y,{children:[t.jsx(p,{}),t.jsx(c,{}),t.jsx(T,{children:t.jsxs("fieldset",{style:{display:"inline",border:"1px solid red"},children:[t.jsx("legend",{children:"Error Boundary"}),t.jsx(c,{}),t.jsx(f,{})]})})]});h.displayName="Bar";const m=()=>t.jsx(h,{});m.displayName="Foo";const E=()=>t.jsxs(t.Fragment,{children:[t.jsx("div",{children:"Hello World"}),t.jsx(m,{})]});E.displayName="App";function s(e){if(e.componentStack)return e.componentStack.trim().split(`
`).map(r=>r.trim().replace(/^at (.*?) \(.*?\)$/,"$1")).reverse().join(" > ")}const l=document.getElementById("button");l.addEventListener("click",()=>{k.createRoot(document.getElementById("node"),{onCaughtError(e,r){const n=r.errorBoundary?._reactInternals;console.log("Error caught by Error Boundary",{boundaryStack:n?d(n).fiberStack:null,errorStack:s(r)})},onUncaughtError(e,r){console.log("Error not caught by Error Boundary",{errorStack:s(r),error:e})},onRecoverableError(e,r){console.log("Recoverable error",{errorStack:s(r),error:e})}}).render(t.jsx(E,{})),l.disabled=!0});
