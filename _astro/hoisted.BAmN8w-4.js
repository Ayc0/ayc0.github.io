import{j as e}from"./jsx-runtime.Biu9vCfE.js";import{R as s}from"./index.CSLRt44l.js";import{r as w,c as C}from"./client.Df7LOKtL.js";const E=()=>`lch(${Math.floor(Math.random()*20)+50}% ${Math.floor(Math.random()*50)+50} ${Math.floor(Math.random()*360)})`;let d=65;const g=s.createContext(!1);function v(n,o,r){r?(console.log(performance.now().toFixed(1)+"ms "+n,o),queueMicrotask(function(){console.log(performance.now().toFixed(1)+"ms microtask "+n,o)}),requestAnimationFrame(function(){console.log(performance.now().toFixed(1)+"ms requestAnimationFrame "+n,o)}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms user-blocking task "+n,o)},{priority:"user-blocking"}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms user-visible task "+n,o)},{priority:"user-visible"}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms background task "+n,o)},{priority:"background"})):console.log(n,o)}class a extends s.Component{state={error:!1};static getDerivedStateFromError(){return{error:!0}}render(){return this.state.error?e.jsx("div",{style:{border:"2px dashed red"},children:"Oops"}):e.jsx(s.Suspense,{fallback:e.jsx("div",{style:{border:"4px dotted blue",padding:"4px"},children:"⏸️"}),children:e.jsx("div",{style:{border:"4px dotted red",padding:"4px"},children:this.props.children})})}}function m(){const[n,o]=s.useState(!1);if(n)throw new Error("oops");return e.jsx("span",{onClick:()=>o(!0),children:"💥"})}function f(){const[n,o]=s.useState(!1);if(n)throw new Promise(r=>{});return e.jsx("span",{onClick:()=>o(!0),children:"🚧"})}class u extends s.Component{static contextType=g;color=E();componentId=String.fromCharCode(d++);log(o){v(`%cComponent ${this.componentId}: ${o}`,`color: ${this.color}`,this.context)}constructor(o){super(o),this.log("constructor")}componentWillMount(){this.log("componentWillMount")}componentWillReceiveProps(){this.log("componentWillReceiveProps")}componentWillUpdate(){this.log("componentWillUpdate")}componentDidMount(){this.log("componentDidMount")}componentDidUpdate(){this.log("componentDidUpdate")}shouldComponentUpdate(){return this.log("shouldComponentUpdate"),!0}getSnapshotBeforeUpdate(){this.log("getSnapshotBeforeUpdate")}componentWillUnmount(){this.log("componentWillUnmount")}render(){return this.log("render"),e.jsxs("div",{ref:function(r){this.log("ref "+(r?"node":"null"))}.bind(this),style:{border:`2px ${this.props.dashed?"dashed":"solid"} ${this.color}`},children:[e.jsxs("div",{children:[this.componentId,e.jsx("span",{onClick:()=>this.forceUpdate(),children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column"},children:this.props.children})]})}}class M extends u{render(){return this.log("render"),e.jsxs("div",{ref:function(r){this.log("ref "+(r?"node":"null"))}.bind(this),style:{border:`2px solid ${this.color}`},children:[e.jsxs("div",{children:[this.componentId,"*",e.jsx("span",{onClick:()=>this.forceUpdate(),children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsxs("div",{style:{display:"grid",gridAutoFlow:"column"},children:[e.jsx("span",{}),e.jsx(u,{dashed:!0}),e.jsx("span",{})]})]})}}function S(){return e.jsxs(u,{children:[e.jsx(a,{children:e.jsx(u,{children:e.jsx(u,{})})}),e.jsx(a,{children:e.jsx(M,{})})]})}const b=()=>{const n=s.useMemo(()=>E(),[]),o=s.useMemo(()=>String.fromCharCode(d++),[]),r=s.useContext(g),t=s.useCallback(l=>{v(`%cComponent ${o}: ${l}`,`color: ${n}`,r)},[r]);t("render");const[i,c]=s.useState({});return s.useMemo(function(){t("useMemo")},[]),s.useInsertionEffect(function(){return t("useInsertionEffect"),function(){t("useInsertionEffect cleanup")}},[i]),s.useLayoutEffect(function(){return t("useLayoutEffect"),function(){t("useLayoutEffect cleanup")}},[i]),s.useEffect(function(){return t("useEffect"),function(){t("useEffect cleanup")}},[i]),{log:t,color:n,componentId:o,forceUpdate:c}};function h({children:n,dashed:o}){const{log:r,color:t,componentId:i,forceUpdate:c}=b();return e.jsxs("div",{ref:function(p){r("ref "+(p?"node":"null"))},style:{border:`2px ${o?"dashed":"solid"} ${t}`},children:[e.jsxs("div",{children:[i,e.jsx("span",{onClick:()=>c({}),children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column"},children:n})]})}function T({children:n}){const{log:o,color:r,componentId:t,forceUpdate:i}=b();return e.jsxs("div",{ref:function(l){o("ref "+(l?"node":"null"))}.bind(this),style:{border:`2px solid ${r}`},children:[e.jsxs("div",{children:[t,"*",e.jsx("span",{onClick:()=>i({}),children:"🔄"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsxs("div",{style:{display:"grid",gridAutoFlow:"column"},children:[e.jsx("span",{}),e.jsx(h,{dashed:!0}),e.jsx("span",{})]})]})}function F(){return e.jsxs(h,{children:[e.jsx(a,{children:e.jsx(h,{children:e.jsx(h,{})})}),e.jsx(a,{children:e.jsx(T,{})})]})}const j={class:S,function:F};function y(){const[n,o]=s.useState(null),r=j[n],[t,i]=s.useState(!1);return e.jsxs("div",{className:"App",children:[e.jsxs("div",{children:["Timing ",t?"enabled ":"disabled ",e.jsx("button",{onClick:()=>{console.clear(),d=65,i(!t)},children:t?"️⌛":"⏳"})]}),e.jsxs("div",{children:["Pick example:",e.jsx("button",{onClick:()=>{console.clear(),d=65,o(null)},children:"Remove all"}),Object.keys(j).map(c=>e.jsx("button",{onClick:()=>{console.clear(),d=65,o(c)},children:c},c))]}),e.jsx(g.Provider,{value:t,children:e.jsx(a,{children:r&&e.jsx(r,{},String(t))})})]})}const x=!!sessionStorage.getItem("legacyRoot");function I(){return e.jsx(e.Fragment,{children:e.jsxs("button",{onClick:()=>{x?sessionStorage.removeItem("legacyRoot"):sessionStorage.setItem("legacyRoot","true"),window.location.reload()},children:["Switch to ",x?"concurrent":"legacy"]})})}const k=document.getElementById("root");x?w.render(e.jsx(y,{}),k):C(k).render(e.jsx(y,{}));C(document.getElementById("switcher")).render(e.jsx(I,{}));
