import{j as e}from"./jsx-runtime.BPj4-Rfu.js";import{R as s}from"./index.SSXOyoI7.js";import{r as w,c as C}from"./client.CjOa4Xn9.js";import"./index.CzFDRTuY.js";const E=()=>`lch(${Math.floor(Math.random()*20)+50}% ${Math.floor(Math.random()*50)+50} ${Math.floor(Math.random()*360)})`;let d=65;const g=s.createContext(!1);function v(o,t,r){r?(console.log(performance.now().toFixed(1)+"ms "+o,t),queueMicrotask(function(){console.log(performance.now().toFixed(1)+"ms microtask "+o,t)}),requestAnimationFrame(function(){console.log(performance.now().toFixed(1)+"ms requestAnimationFrame "+o,t)}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms user-blocking task "+o,t)},{priority:"user-blocking"}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms user-visible task "+o,t)},{priority:"user-visible"}),scheduler.postTask(function(){console.log(performance.now().toFixed(1)+"ms background task "+o,t)},{priority:"background"})):console.log(o,t)}class a extends s.Component{constructor(){super(...arguments),this.state={error:!1}}static getDerivedStateFromError(){return{error:!0}}render(){return this.state.error?e.jsx("div",{style:{border:"2px dashed red"},children:"Oops"}):e.jsx(s.Suspense,{fallback:e.jsx("div",{style:{border:"4px dotted blue",padding:"4px"},children:"â¸ï¸"}),children:e.jsx("div",{style:{border:"4px dotted red",padding:"4px"},children:this.props.children})})}}function m(){const[o,t]=s.useState(!1);if(o)throw new Error("oops");return e.jsx("span",{onClick:()=>t(!0),title:"throw error",children:"ðŸ’¥"})}function f(){const[o,t]=s.useState(!1);if(o)throw new Promise(r=>{});return e.jsx("span",{onClick:()=>t(!0),title:"trigger infinite suspense",children:"ðŸš§"})}class u extends s.Component{constructor(t){super(t),this.color=E(),this.componentId=String.fromCharCode(d++),this.log("constructor")}static{this.contextType=g}log(t){v(`%cComponent ${this.componentId}: ${t}`,`color: ${this.color}`,this.context)}componentWillMount(){this.log("componentWillMount")}componentWillReceiveProps(){this.log("componentWillReceiveProps")}componentWillUpdate(){this.log("componentWillUpdate")}componentDidMount(){this.log("componentDidMount")}componentDidUpdate(){this.log("componentDidUpdate")}shouldComponentUpdate(){return this.log("shouldComponentUpdate"),!0}getSnapshotBeforeUpdate(){this.log("getSnapshotBeforeUpdate")}componentWillUnmount(){this.log("componentWillUnmount")}render(){return this.log("render"),e.jsxs("div",{ref:function(r){this.log("ref "+(r?"node":"null"))}.bind(this),style:{border:`2px ${this.props.dashed?"dashed":"solid"} ${this.color}`},children:[e.jsxs("div",{children:[this.componentId,e.jsx("span",{onClick:()=>this.forceUpdate(),title:"re-render",children:"ðŸ”„"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column"},children:this.props.children})]})}}class M extends u{render(){return this.log("render"),e.jsxs("div",{ref:function(r){this.log("ref "+(r?"node":"null"))}.bind(this),style:{border:`2px solid ${this.color}`},children:[e.jsxs("div",{children:[this.componentId,"*",e.jsx("span",{onClick:()=>this.forceUpdate(),title:"re-render",children:"ðŸ”„"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsxs("div",{style:{display:"grid",gridAutoFlow:"column"},children:[e.jsx("span",{}),e.jsx(u,{dashed:!0}),e.jsx("span",{})]})]})}}function T(){return e.jsxs(u,{children:[e.jsx(a,{children:e.jsx(u,{children:e.jsx(u,{})})}),e.jsx(a,{children:e.jsx(M,{})})]})}const b=()=>{const o=s.useMemo(()=>E(),[]),t=s.useMemo(()=>String.fromCharCode(d++),[]),r=s.useContext(g),n=s.useCallback(l=>{v(`%cComponent ${t}: ${l}`,`color: ${o}`,r)},[r]);n("render");const[i,c]=s.useState({});return s.useMemo(function(){n("useMemo")},[]),s.useInsertionEffect(function(){return n("useInsertionEffect"),function(){n("useInsertionEffect cleanup")}},[i]),s.useLayoutEffect(function(){return n("useLayoutEffect"),function(){n("useLayoutEffect cleanup")}},[i]),s.useEffect(function(){return n("useEffect"),function(){n("useEffect cleanup")}},[i]),{log:n,color:o,componentId:t,forceUpdate:c}};function p({children:o,dashed:t}){const{log:r,color:n,componentId:i,forceUpdate:c}=b();return e.jsxs("div",{ref:function(h){r("ref "+(h?"node":"null"))},style:{border:`2px ${t?"dashed":"solid"} ${n}`},children:[e.jsxs("div",{children:[i,e.jsx("span",{onClick:()=>c({}),title:"re-render",children:"ðŸ”„"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsx("div",{style:{display:"grid",gridAutoFlow:"column"},children:o})]})}function S({children:o}){const{log:t,color:r,componentId:n,forceUpdate:i}=b();return e.jsxs("div",{ref:function(l){t("ref "+(l?"node":"null"))}.bind(this),style:{border:`2px solid ${r}`},children:[e.jsxs("div",{children:[n,"*",e.jsx("span",{onClick:()=>i({}),title:"re-render",children:"ðŸ”„"}),e.jsx(m,{}),e.jsx(f,{})]}),e.jsxs("div",{style:{display:"grid",gridAutoFlow:"column"},children:[e.jsx("span",{}),e.jsx(p,{dashed:!0}),e.jsx("span",{})]})]})}function F(){return e.jsxs(p,{children:[e.jsx(a,{children:e.jsx(p,{children:e.jsx(p,{})})}),e.jsx(a,{children:e.jsx(S,{})})]})}const j={class:T,function:F};function y(){const[o,t]=s.useState(null),r=j[o],[n,i]=s.useState(!1);return e.jsxs("div",{className:"App",children:[e.jsxs("div",{children:["Timing ",n?"enabled ":"disabled ",e.jsx("button",{title:`Toggle timing to ${n?"disabled ":"enabled "}`,onClick:()=>{console.clear(),d=65,i(!n)},children:n?"ï¸âŒ›":"â³"})]}),e.jsxs("div",{children:["Pick example:",e.jsx("button",{onClick:()=>{console.clear(),d=65,t(null)},children:"Remove all"}),Object.keys(j).map(c=>e.jsx("button",{onClick:()=>{console.clear(),d=65,t(c)},children:c},c))]}),e.jsx(g.Provider,{value:n,children:e.jsx(a,{children:r&&e.jsx(r,{},String(n))})})]})}const x=!!sessionStorage.getItem("legacyRoot");function I(){return e.jsx(e.Fragment,{children:e.jsxs("button",{onClick:()=>{x?sessionStorage.removeItem("legacyRoot"):sessionStorage.setItem("legacyRoot","true"),window.location.reload()},children:["Switch to ",x?"concurrent":"legacy"]})})}const k=document.getElementById("root");x?w.render(e.jsx(y,{}),k):C(k).render(e.jsx(y,{}));C(document.getElementById("switcher")).render(e.jsx(I,{}));
